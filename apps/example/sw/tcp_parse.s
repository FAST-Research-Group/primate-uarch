# R0: 0
# R1: ETHERNET
# R2: IPV4
# R3: TCP
# R4: UDP
# R5: TCP_OPTION
# R6: PADDING
# R7: HDR_BYTE_LEFT
#         0 1 2  3  4  5  6  7   8   9
# SRC_POS=0 8 48 64 72 80 96 100 112 160 
#          0 1 2  3  4  5  6  7  8  9   10
# SRC_MODE=4 8 16 48 60 64 72 80 96 256 256 
# ALU0/BFU0;ALU1/MEM;INPUT_OUTPUT;BRANCH;
LUi,R2,0,10,4096;NOP;EXTRACTi,R1,0,10,R0,0,10,14;NOP;#
ADDi,R0,0,10,R1,6,2,0;ADDi,R0,0,10,R2,0,10,-2048;EMIT,R0,0,10,R1,0,10,14;BNE,X0,X1,20;#
NOP;NOP;EXTRACTi,R2,0,10,R0,0,10,20;NOP;#
ADDi,R0,0,10,R2,4,1,0;ADDi,R0,0,10,R0,0,10,6;EMIT,R0,0,10,R2,0,10,20;BNE,X0,X1,16;#
NOP;NOP;EXTRACTi,R3,0,10,R0,0,10,20;NOP;#
ADDi,R0,0,10,R3,6,0,0;ADDi,R0,0,10,R0,0,10,1;EMIT,R0,0,10,R3,0,10,20;BGE,X0,X1,16;#
NOP;NOP;PARSE_DONE;END;#
NOP;NOP;EXTRACTi_DONE,R4,0,10,R0,0,10,8;NOP;#
NOP;NOP;EMIT,R0,0,10,R4,0,10,8;END;#
ADDi,R7,0,10,R3,6,0,-5;NOP;NOP;NOP;#
SLLi,R7,0,10,R7,0,10,2;ADDi,R0,0,10,R0,0,10,1;NOP;BLT,X0,X1,36;#
NOP;NOP;EXTRACTi,R5,0,10,R0,0,10,1;NOP;#
ADDi,R0,0,10,R5,0,10,0;ADDi,R0,0,10,R0,0,10,0;EMIT,R0,0,10,R5,0,10,1;BNE,X0,X1,24;#
ADDi,R7,0,10,R7,0,10,-1;ADDi,R0,0,10,R0,0,10,33;NOP;BLT,X0,X1,12;#
NOP;NOP;EXTRACTi,R6,0,10,R0,0,10,32;NOP;#
ADDi,R7,0,10,R7,0,10,-32;NOP;EMIT,R0,0,10,R6,0,10,32;J,-8;#
NOP;NOP;EXTRACTi_DONE,R6,0,10,R7,0,10,0;NOP;#
NOP;NOP;EMIT,R0,0,10,R6,0,10,32;END;#
ADDi,R7,0,10,R7,0,10,-1;ADDi,R0,0,10,R0,0,10,1;NOP;BGE,X0,X1,-28;#
NOP;NOP;PARSE_DONE;END;#
